
## Pedestrian/Car Detection
### 思路
对于行人/车辆检测，常见的解决方案是通过深度学习模型进行训练和预测。一些常用的检测器包括Faster R-CNN、YOLO、SSD等。
Faster R-CNN、YOLO、SSD是目前较为流行的物体检测算法。它们各有优劣，具体如下：
* Faster R-CNN：
  优点：较高的检测准确率、适用于小样本数据集、可检测不同尺寸的目标。
  缺点：计算速度相对较慢。
* YOLO：
  优点：非常快的检测速度、应用于实时检测任务、支持多类别检测。
  缺点：在小目标上易受到误差和漏检。
* SSD：
  优点：平衡了速度和准确率、对小目标具有很好的检测能力、适合于实时性要求较高的任务。
  缺点：相对于Faster R-CNN模型，准确率可能略低。

需要注意的是，选择哪一种检测器取决于具体的应用场景和需求。如果是注重速度的实时检测场景，可以选择YOLO或者SSD；如果关注准确率并且有足够的计算资源，则可以选择Faster R-CNN。

我们小组认为树莓派算力有限，因此选择在PC端使用PyTorch训练模型，然后在树莓派上使用OpenCV进行物体检测：
1. 使用PyTorch在PC端训练模型：使用PyTorch编写代码，定义模型结构、数据集和损失函数等，并通过反向传播算法优化模型参数。训练完成后，将训练好的模型保存为.pth或.pt格式。
2. 将训练好的模型转换为ONNX格式：由于树莓派的硬件资源有限，需要使用OpenCV中的dnn模块进行推理，因此需要将训练好的模型转换为ONNX格式，以便在树莓派上使用。可以使用PyTorch提供的`torch.onnx.export`函数将模型导出为ONNX格式。
3. 在树莓派上使用OpenCV进行物体检测：使用OpenCV加载ONNX格式的模型，并对图像进行预测。可以使用OpenCV中的`cv2.dnn.readNetFromONNX`函数加载ONNX格式的模型，并调用`cv2.dnn.blobFromImage`函数处理输入图像，最后调用`cv2.dnn.forward`函数进行预测和输出结果。

需要注意的是，在将模型从PyTorch转换为ONNX格式过程中，可能会涉及到一些模型的兼容性问题。并且在将模型转换为ONNX格式后，可能会引入一些精度损失的问题，需要进行适当的调整和优化。
总体来说，在PC端训练模型，在树莓派上使用OpenCV进行物体检测是可行的。但由于开发环境、硬件设备等方面的不同，具体实现过程可能会有所差异。

### HOG+SVM
HOG（Histogram of Oriented Gradients，梯度方向直方图）是一种常用的图像特征提取方法，可以在目标检测、行人检测等领域发挥重要作用。而线性SVM（Support Vector Machine，支持向量机）是一种常用的分类器，主要用于将不同类别的样本分开，广泛应用于文本分类、图像分类等任务中。

由于OpenCV自带HOG+线性SVM模型，我们选择直接调用（能力不够搓不出来轮子orz。
OpenCV中自带的HOG+SVM模型是一种基于HOG特征和线性SVM分类器的目标检测模型，其主要步骤如下：
1. 提取图像的HOG特征，即将图像划分成多个相邻的小块，计算每个块内像素的梯度方向和幅值，然后对所有块内的梯度方向进行统计，形成一个特征向量。
2. 使用从训练数据中得到的正样本图像和负样本图像训练一个线性SVM分类器，使其能够区分出目标物体和非目标物体。
3. 在测试图像上通过滑动窗口来检测目标物体，每次将一个窗口内的图像块提取出来，计算其HOG特征，并利用已经训练好的线性SVM分类器进行分类，以确定该窗口是否包含目标物体。

OpenCV中提供了训练和检测两个函数，分别为`cv2.HOGDescriptor()`和`detectMultiscale()`。其中，`cv2.HOGDescriptor()`用于设置HOG特征的参数，如窗口大小、块大小、梯度方向数等；`detectMultiscale()`用于在测试图像上进行多尺度检测，返回所有检测到的目标物体的位置和可信度得分。

使用这种方法需要一些训练样本，可以采用已有的数据集或自己收集数据进行训练。比如，OpenCV中自带的`pedestrian.xml`文件就是一个预训练好的HOG+SVM模型，在行人检测任务中具有较高的准确率。